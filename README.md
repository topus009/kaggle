# CAPTCHA OCR - Kaggle CAPTCHA Recognition Model

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ CAPTCHA –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º TensorFlow –∏ Keras.

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Accuracy –Ω–∞ Kaggle**: 95%
- **–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏**: ~0.1-0.2 —Å–µ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã**: –†—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã
- **–ú–æ–¥–µ–ª—å**: CTC-based LSTM Neural Network

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
kaggle/
‚îú‚îÄ‚îÄ final-results/output/
‚îÇ   ‚îî‚îÄ‚îÄ model.keras              # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (95% accuracy)
‚îú‚îÄ‚îÄ images/                       # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ labels.csv              # –ú–µ—Ç–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ images/                 # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è CAPTCHA
‚îú‚îÄ‚îÄ predict.py                  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îú‚îÄ‚îÄ test_real_captcha.py        # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md                   # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 2. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
```bash
# –û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
python predict.py --image path/to/image.png --output results

# –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
python predict.py --folder path/to/images --output results
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA —Å FSSP API
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å 5 CAPTCHA –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
python test_real_captcha.py --count 5

# –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
python test_real_captcha.py --count 10 --no-test

# –° –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–∞–ø–∫–∞–º–∏
python test_real_captcha.py --count 5 --captcha-folder mycaptchas --output-folder myresults
```

## üìù –°–∫—Ä–∏–ø—Ç—ã

### predict.py
–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ CAPTCHA.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python predict.py --folder images/images --output results
```

**–ê—Ä–≥—É–º–µ–Ω—Ç—ã:**
- `--image, -i` - –ü—É—Ç—å –∫ –æ–¥–Ω–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
- `--folder, -f` - –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- `--model, -m` - –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `final-results/output/model.keras`)
- `--output, -o` - –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–í—ã—Ö–æ–¥:**
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `{output_folder}/predictions.txt`
- –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º –≤ `{output_folder}/`

### test_real_captcha.py
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA —Å FSSP API –∏ –∏—Ö —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python test_real_captcha.py --count 5
```

**–ê—Ä–≥—É–º–µ–Ω—Ç—ã:**
- `--count, -c` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CAPTCHA –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)
- `--no-test` - –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å, –±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `--captcha-folder` - –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CAPTCHA (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `test_captchas`)
- `--output-folder` - –ü–∞–ø–∫–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `real_results`)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ FSSP API
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç CAPTCHA –≤ —Ñ–æ—Ä–º–∞—Ç–µ base64
3. –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∞–∫ PNG
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç predict.py –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `predictions.txt`:

```
============================================================
–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ô CAPTCHA
============================================================

–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 6
------------------------------------------------------------

captcha_20251029_234905_164_1.png: –±8–º6–∂
captcha_20251029_234906_140_2.png: –ª–≥–≤–∂–≥
captcha_20251029_234957_481_1.png: 2–≤–Ω45
captcha_20251029_234958_328_2.png: –≤89—Å5—Ä
captcha_20251029_235008_239_1.png: —Å–Ω2–ª–ø
captcha_20251029_235009_073_2.png: –º—Ä–∂6–≥—Å

============================================================
```

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- TensorFlow >= 2.10.0
- NumPy >= 1.23.0
- Requests >= 2.28.0
- Pillow >= 9.5.0
- OpenCV >= 4.6.0

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –≤ `requirements.txt`

## üìÇ –ü–∞–ø–∫–∏ (–≤ .gitignore)

- `results/` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `test_captchas/` - –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª—å–Ω—ã–µ CAPTCHA
- `real_results/` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA

## üîó API FSSP

–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA:
- **Endpoint**: `https://is.fssp.gov.ru/refresh_visual_captcha/`
- **–ú–µ—Ç–æ–¥**: GET (JSONP)
- **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞**: JSONP —Å base64 encoded PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ –ø–æ–ª–µ `image`

## üí° –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
python predict.py --folder images/images --output results
cat results/predictions.txt
```

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–≥—Ä—É–∑–∏—Ç—å 10 —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
```bash
python test_real_captcha.py --count 10
cat real_results/predictions.txt
```

### –ü—Ä–∏–º–µ—Ä 3: –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å CAPTCHA –±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
python test_real_captcha.py --count 20 --no-test
# CAPTCHA —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ test_captchas/
```

## üìã –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö CAPTCHA (–±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞: 7 —Å–∏–º–≤–æ–ª–æ–≤
- –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 200x60 –ø–∏–∫—Å–µ–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CTC loss –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ CTC –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- –°–∫—Ä–∏–ø—Ç—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç GUI - –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

- **Input**: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 200x60 RGB
- **Preprocessing**: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Architecture**: LSTM-based CNN
- **Output**: CTC-decoded —Ç–µ–∫—Å—Ç (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞)
- **Loss**: CTC Loss (Connectionist Temporal Classification)

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA

–ù–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö CAPTCHA —Å FSSP API –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤
- –°–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ç–∏–ª—è–º–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö.

## üë®‚Äçüíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Framework**: TensorFlow / Keras
- **Language**: Python 3.11+
- **API Client**: Requests
- **Image Processing**: OpenCV, Pillow
- **Data Processing**: NumPy, Pandas
